<div class="good-detail sift-mg">
	<h3 class="h_h3"><%=@product.name%><font color="red"></font> </h3>
	<script type="text/javascript">
			
			var widths=180;
			var heights=180;
			var counts=1;
							img1=new Image();img1.src='<%=@product.good.icon%>';img1.src1='<%=@product.good.icon%>';
				url1=new Image();url1.src='javascript:;';
				var img
						var nn=1;
			var key=0;
			function change_img(){
				if(key==0){
					key=1;
				}else if(document.all) {
					document.getElementById("pic").filters[0].Apply();document.getElementById("pic").filters[0].Play(duration=2);
				}
				eval('document.getElementById("pic").src=img'+nn+'.src1');
				eval('document.getElementById("url").href=url'+nn+'.src');
				for (var i=1;i <=counts;i++){
					document.getElementById("xxjdjj"+i).className='axx';
				}
				document.getElementById("xxjdjj"+nn).className='bxx';
				nn++;if(nn>counts){
					nn=1;
				}
				tt=setTimeout('change_img()',4000);
			}
			function changeimg(n){
				nn=n;window.clearInterval(tt);change_img();
			}
			document.write('<style type="text/css">');
			document.write('.axx,.bxx{display:inline-block;width:35px;height:15px;margin:0 4px;overflow: hidden;text-indent: -99px;border: 1px solid #a5a5a5;box-shadow: 0 0 1px #999;border-radius: 5px;-webkit-border-radius: 5px;-moz-border-radius: 5px;}');
			document.write('a.axx:link,a.axx:visited{background-color:#F5F0E1;}');
			document.write('a.axx:active,a.axx:hover{background-color:#999;}');
			document.write('a.bxx:link,a.bxx:visited{background-color:#B5B5B5;}');
			document.write('a.bxx:active,a.bxx:hover{background-color:#B5B5B5;}');
			
			document.write('</style>');
			document.write('<div id="workDemo" style="width:'+widths+'px;height:'+heights+';overflow:hidden;text-overflow:clip;margin:0px auto;padding-top:20px;text-align: center;">');
			document.write('<div><a id="url"><img id="pic" style="border:0px;box-shadow: -2px 2px 2px #999;" width='+widths+' height='+heights+' /> </a> </div>');
			document.write('<div style="margin-top:6px;">');
			for(var i=1;i <counts+1;i++){
				document.write('<a href="javascript:changeimg('+i+');" id="xxjdjj'+i+'" class="axx" target="_self">'+i+' </a>');
			}
			document.write('</div></div>');
			change_img();
			//点击显示大图
				function ImgShow(evt){
				var imgTag=(window.event)?event.srcElement:evt.target;
				var imgPath=imgTag.src.replace(/\_\d\./,"_4.");   // 取得弹出的大图url
				var tagTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);
				var tag=document.createElement("div");
					tag.style.cssText="width:100%;height:"+Math.max(document.body.clientHeight,document.body.offsetHeight,document.documentElement.clientHeight)+"px;position:absolute;background:black;top:0;filter: Alpha(Opacity=60);Opacity:0.6;";
					tag.ondblclick=closes;
				var tagImg=document.createElement("div");
					tagImg.style.cssText="overflow:hidden;text-align:center;position:absolute;border:0px solid #FFFFFF;background:white;left:"+(parseInt(document.body.offsetWidth)/2-100)+"px;top:"+(document.documentElement.clientHeight/3+tagTop)+"px;"
					tagImg.innerHTML="<div style='padding:0px;background:#FFFFFF;border:1px solid #333333'><img src='../images/loading.gif' /></div>";
				var closeTag=document.createElement("div");
					closeTag.style.cssText="display:block;width:30px;height:30px;position:absolute;right:10px;top:10px;border:0px solid #ffffff;";
					var closesHtml="<img src='../images/close.png' title='关闭' weight=30px height=30px/>";
					closeTag.innerHTML=closesHtml+"";
					closeTag.onclick=closes;
				document.body.appendChild(tag);
				document.body.appendChild(tagImg);
				var img=new Image();
					img.src=imgPath;
					img.style.cssText="border:1px solid #FFFFFF;filter: Alpha(Opacity=0);Opacity:0";
				var barShow,imgTime;
				img.complete?ImgOK():img.onload=ImgOK;
				function ImgOK(){
					var Stop1=false,Stop2=false,temp=0;
					var tx=tagImg.offsetWidth,ty=tagImg.offsetHeight;
					var ix=img.width,iy=img.height;
					var sx=document.documentElement.clientWidth,sy=window.innerHeight||document.documentElement.clientHeight;
					if(iy>sy||ix>sx){
							var yy=sy-100;
							var xx=(ix/iy)*yy;
					}else{
						var xx=ix;
						var yy=iy;
					}
						img.style.width=xx+'px';
						img.style.width='250px';
						img.style.height=yy+'px';
						img.style.height='250px';
					if(ix<sx&&iy<sy){tagImg.alt="";closeTag.innerHTML=closesHtml;};
					
					var maxTime=setInterval(function(){
						temp+=35;
						if((tx+temp)<xx){
							tagImg.style.width=(tx+temp)+"px";
							tagImg.style.left=(sx-(tx+temp))/2+"px";
						}else{
							Stop1=true;
							tagImg.style.width=xx+"px";
							tagImg.style.left=(sx-xx)/2+"px";
						}
						if((ty+temp)<yy){
							tagImg.style.height=(ty+temp)+"px";
							tagImg.style.top=(tagTop+((sy-(ty+temp))/2))+"px";
						}else{
							Stop2=true;
							tagImg.style.height=yy+"px";
							tagImg.style.top=(tagTop+((sy-yy)/2))+"px";
						}
						
						tagImg.style.left=(document.body.clientWidth-250)/2+'px';
						tagImg.style.top=(document.body.clientHeight-250)/2+'px';
						tagImg.style.width='250px';
						tagImg.style.height="250px";
						if(Stop1&&Stop2){
							clearInterval(maxTime);
							tagImg.appendChild(img);
							temp=0;
							imgOPacity();
						}
					},1);
					
					function imgOPacity(){
						temp+=10;
						img.style.filter="alpha(opacity="+temp+")";
						img.style.opacity=temp/100;
						imgTime=setTimeout(imgOPacity,1)
						if(temp>100) clearTimeout(imgTime);
					}
					tagImg.innerHTML="";
					tagImg.appendChild(closeTag);
					tagImg.style.overflow="visible";
				}
				
				function closes(){
					document.body.removeChild(tag);
					document.body.removeChild(tagImg);
					clearTimeout(barShow);
					clearTimeout(imgTime);
					document.onmouseup=null;
					tag=img=tagImg=closeTag=null;
				}
			}
			//事件绑定部分
			if(document.getElementById("workDemo")){
				var workTag=document.getElementById("workDemo");
				var workImg=workTag.getElementsByTagName("img"); //  注册此处会把 workDemo下的所有img选中，包括子集下的子集。
				var worka=workTag.getElementsByTagName("a");
				for(var i=0; i<workImg.length; i++){workImg[i].onclick=ImgShow;}
			}
			
		</script>

	<%=simple_form_for [:mobile,CartItem.new],:remote=>true do |f|%>
	<%= tag(:input, :type => "hidden", :name =>   
	request_forgery_protection_token.to_s, :value =>   
	form_authenticity_token) %>
	<ul class="mu_lw">
		<li class="mu_l"> <span class="mu_lh">编号：</span> <span class="mu_lc"><%=@product.no%></span></li>
		<li class="mu_l"><span class="mu_lh">重量：</span> <span class="mu_lc price-txt"><%=@product.good.weight%>/<%=@product.good.unit%></span></li>
		<li class="mu_l"><span class="mu_lh">市场价：</span> <span class="mu_lc q-txt"><del><%=number_to_currency @product.mk_price,:unit=>"&yen"%></del></span></li>
		<li class="mu_l"><span class="mu_lh">商品价格：</span> <span class="mu_lc red q-txt" id="ECS_SHOPPRICE"><%=number_to_currency @product.price,:unit=>"&yen"%></span></li>					
		
		<li class="mu_l"><span class="mu_lh">购买数量：</span> <span class="mu_lc q-txt">
			<%=f.text_field :quantity,:value=>1,:class=>"input-mini"%></span></li>
		<li class="mu_l" style="margin-top:10px;">
			<%=f.hidden_field :product_id,:value=>@product.id%>
		<div class="btn-section"> 
			<%if @product.on_sale%>
			<span class="btn-tbl-cell"> 
				<%= f.submit "加入购物车",:class=>"btn-add-cart btn_font btn-block"%>
			</span>
			<%else%>
			<span class="btn-tbl-cell"> 
				<%= link_to "已下架","#",:class=>"btn-add-cart btn_font btn-block"%>
			</span>
			<%end%>
			
		</div>
			
		</li>
	</ul>
	<%end%>

	<div class="parting-line"></div>
	<div>
		<h4>商品详情</h4> <br/>
		<pre><%=raw @product.good.intro%></pre>
	</div>	
	
	<div class="parting-line"></div>
	 </div>
<div class="to-top"><a href="javascript:scroll(0,0)" hidefocus="true"><span></span>回顶部</a></div>